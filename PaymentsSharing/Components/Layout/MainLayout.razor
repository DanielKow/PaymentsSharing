@inherits LayoutComponentBase
@inject CurrentPerson CurrentPerson

<MudThemeProvider/>
<MudDialogProvider/>
<MudSnackbarProvider/>

<MudLayout>
    @if (CurrentPerson.IsSignedIn)
    {
        <MudAppBar>
            <AppBar @bind-DrawerOpen="_drawerOpen"></AppBar>
        </MudAppBar>
        <MudDrawer @bind-Open="@_drawerOpen" ClipMode="DrawerClipMode.Docked">
            <NavMenu/>
        </MudDrawer>
        <MudMainContent>
            <MudContainer MaxWidth="MaxWidth.Medium" Class="mt-10">
                @Body
            </MudContainer>
        </MudMainContent>
    }
    else
    {
        <MudContainer MaxWidth="MaxWidth.Medium" Class="mt-10">
            <SignInForm/>
        </MudContainer>
    }
</MudLayout>

@code {

    private bool _drawerOpen;

    protected override void OnInitialized()
    {
        CurrentPerson.OnCurrentPersonChanged += () => InvokeAsync(StateHasChanged);
    }

}